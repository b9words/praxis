Excellent. This is a crucial evolution. Moving from purely synthetic content to case studies grounded in real-world evidence is what separates a good learning platform from a world-class one. It's the key to making the experience feel authentic and genuinely valuable, not like a toy.

You are right to question a fully automated system. As of late 2025, a reliable, fully automated system to source, verify, and format diverse, high-quality evidence from the web is not feasible for production. It would be brittle and legally fraught.

However, we can design an **AI-assisted "Cyborg" workflow**. This approach uses AI for what it does best—synthesis, pattern recognition, and research direction—and leverages human intelligence for what it does best—verification, sourcing from complex websites, and quality control.

Here is a specific, robust plan to implement this system.

---

### **Part 1: The Strategic Framework — The "Digital Briefing Book"**

First, we must redefine what a case study is on your platform. It is no longer a single document. It is a **Digital Briefing Book**—a curated collection of primary source documents and data that form the basis for a simulation.

Each Briefing Book will consist of:
*   **A Narrative Brief (`briefing.md`):** A compelling narrative written by the AI that sets the scene, introduces the characters (personas), and frames the central problem.
*   **A Collection of Evidence Files:** A set of real-world documents that the user must analyze. These are the files you will source manually. Examples include:
    *   **Financial Tables (`.csv`):** Extracted from a 10-Q or annual report.
    *   **Market Data (`.csv`):** From industry reports.
    *   **Primary Source Snapshots (`.png`):** Screenshots of news headlines, journal abstracts, or key charts.
    *   **Internal Communications (`.md`):** Mock "internal memos" or "Slack conversations" synthesized by the AI based on real events.

This structure immediately makes the experience more immersive and valuable. The user isn't just reading a story; they are an analyst reviewing a dossier of real intelligence.

---

### **Part 2: The New 3-Phase Content Generation Workflow**

We will overhaul your content generation scripts to follow a three-phase process. This process is designed to be run from your admin panel and will guide you, the content creator, through the sourcing.

#### **Phase 1: AI-Powered Reconnaissance (The "Manifest" Generator)**

The goal of this phase is to have the AI act as an expert research analyst and create a detailed "shopping list" of the evidence you need to find.

1.  **Action:** You will modify your `scripts/generate-case.ts` script. The first step will be to prompt the user (you) for a case study topic (e.g., "Disney's 2017 Streaming Pivot").

2.  **AI Prompt (The Core of the System):** The script then sends a highly structured prompt to the AI:
    > "You are a senior analyst at a top-tier consulting firm preparing a case study for an executive education program. For the topic **'Disney's 2017 Streaming Pivot'**, generate a **'Case File Manifest'**. This manifest must be a JSON object listing 5-7 specific, real-world documents that are essential for understanding this business decision.
    >
    > For each document, provide:
    > 1.  A unique `fileId` (e.g., 'financials_2017').
    > 2.  A descriptive `fileName` (e.g., 'Disney_Media_Networks_Financials_2017.csv').
    > 3.  A `fileType` ('SEC_FILING_TABLE', 'ANALYST_REPORT_SNAPSHOT', 'INTERNAL_MEMO_SYNTHESIS', 'MARKET_DATA_CHART').
    > 4.  A detailed `sourcingGuide` with keywords, potential URLs (like sec.gov/edgar), and instructions on what specific data to look for.
    > 5.  A `synthesisInstruction` explaining how this piece of evidence should be used in the final case narrative."

3.  **Output:** The AI generates a `[case-id]-manifest.json` file. This is your mission briefing.

#### **Phase 2: Human-Led Evidence Gathering**

This phase is manual but guided. You now have a clear, actionable list of what to find.

1.  **Action:** You, the content creator, follow the `sourcingGuide` in the manifest for each file.
    *   For an SEC filing, you go to EDGAR, find the 10-K, locate the "Segment Information" table, and copy it into a `.csv` file.
    *   For a journal screenshot, you go to your university's library portal, find the article, and take a clean screenshot of the abstract or a key chart, saving it as a `.png`.
2.  **Organization:** You save all these sourced files into a new, dedicated folder: `content/sources/[case-id]/`. The filenames must match the `fileName` from the manifest.

#### **Phase 3: AI-Assisted Synthesis & Simulation Creation**

The goal of this phase is to feed the real-world evidence back to the AI and have it construct the final, polished simulation.

1.  **Action:** You run a new script, `scripts/assemble-case.ts`.
2.  **AI Prompt:** This script reads the manifest and all the corresponding evidence files from the `content/sources/` directory. It then sends a new, powerful prompt to the AI:
    > "You are a master storyteller and instructional designer. Using the provided Case File Manifest and the raw content of each sourced file, your task is to write the complete, final `[case-id].json` file for the Execemy simulation platform.
    >
    > Your output must be a single, valid JSON object.
    >
    > 1.  Write a compelling narrative `briefing` that sets the stage, drawing facts and figures directly from the provided evidence.
    > 2.  Structure the `caseFiles` array, referencing each file by its `fileId` and `fileName`.
    > 3.  Design 3-4 interactive `stages` (decision points) that force the user to grapple with the trade-offs revealed in the evidence.
    > 4.  For each stage, write a clear `prompt` and, where appropriate, define `options` or `analystQuestions` that are directly informed by the data in the files.
    > 5.  Use the `synthesisInstruction` from the manifest to guide how you weave each piece of evidence into the case."

3.  **Output:** The AI generates the final, production-ready `[case-id].json` file, which is saved to `data/case-studies/`. You give it a final review and edit before publishing.

---

### **Part 3: Technical Implementation Plan**

This workflow requires specific, targeted changes to your existing structure.

1.  **File Structure Changes:**
    *   Create a new top-level directory: `content/sources/`.
    *   Within `sources`, you will create a sub-directory for each new case study, e.g., `content/sources/cs_disney_streaming_pivot/`.

2.  **Scripting Changes (`scripts/`):**
    *   **`generate-case.ts` (Phase 1):**
        *   Modify this script to take a topic as input.
        *   Implement the "Reconnaissance" prompt to generate the `[case-id]-manifest.json`.
        *   The script should output the manifest and a clear set of instructions for the user on how to proceed with Phase 2 (Evidence Gathering).
    *   **`assemble-case.ts` (Phase 3 - New Script):**
        *   This script will take a `case-id` as an argument.
        *   It will read the `[case-id]-manifest.json` and all files in `content/sources/[case-id]/`.
        *   It will construct and run the "Synthesis" prompt.
        *   It will save the final output to `data/case-studies/[case-id].json`.

3.  **Data & API Layer (`data/`, `app/api/`):**
    *   **`data/case-studies/[case-id].json`:** The structure of your case study JSONs will change slightly. The `caseFiles` array will no longer contain the full content.
        *   **Old:** `source: { type: 'STATIC', content: '...' }`
        *   **New:** `source: { type: 'REFERENCE', path: 'content/sources/cs_disney_streaming_pivot/financials_2017.csv' }`
    *   **New API Route (`app/api/case-content/[...path]/route.ts`):**
        *   You need a secure API route that can read a file from the `content/sources/` directory based on a path parameter and return its content. This prevents exposing your entire file system. The `useCaseFile.ts` hook will call this endpoint.

4.  **Frontend Changes (`components/`, `hooks/`):**
    *   **`hooks/useCaseFile.ts`:**
        *   Update this hook. When it encounters a `source` with `type: 'REFERENCE'`, it must make an API call to the new endpoint to fetch the file content from the given `path`.
    *   **`components/case-study/blocks/DocumentViewerBlock.tsx`:**
        *   This component (and others like it) must be enhanced to render new file types, specifically images (`.png`/`.jpeg`). This can be a simple `<img>` tag that points to a public URL for the image (you can use Supabase Storage to host the sourced images).

This "Cyborg" approach gives you the best of both worlds: the creative and analytical power of AI to structure the case and the quality assurance of a human to source and verify the evidence. It makes your content generation process robust, scalable, and capable of producing the uninspiring, high-value case studies you envision.